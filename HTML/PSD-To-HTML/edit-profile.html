<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Edit Profile</title>
    <link rel="stylesheet" href="./css/style.css" />
    <link rel="stylesheet" href="./css/bootstrap.min.css" />
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"
        integrity="sha256-oP6HI9z1XaZNBrJURtCoUT5SUnxFr8s3BzRl+cbzUq8=" crossorigin="anonymous"></script>
</head>

<body>

    <!-- User profile section begin -->
    <section class="container edit-profile mt-4 d-flex flex-column gap-4 gap-md-5 flex-lg-row">

        <!-- User profile begin -->
        <div
            class="user-profile d-flex flex-column py-4 align-items-center align-self-center align-self-lg-start border gap-2">
            <img for="usr-profile-upload" src="./assets/volunteer4.png" class="rounded-circle cursor-pointer"
                alt="User image" id="usr-profile-img" onclick="document.getElementById('usr-profile-upload').click();">
            <input type="file" hidden id="usr-profile-upload" accept="image/*">
            <p class="text-black-1 mb-0 font-22">Evan Donohue</p>
            <button class="fw-light text-black-1 bg-transparent border-0 font-xs" data-bs-toggle="modal"
                data-bs-target="#changePasswordModal">
                Change Password
            </button>
        </div>
        <!-- User profile end  -->

        <!-- basic information section begin -->
        <div class="flex-grow-1">
            <form action="" id="form-edit-profile">
                <div class="border-bottom">
                    <div class="custom-border-bottom pb-2 mx-content font-22 text-black-1">
                        Basic Information
                    </div>
                </div>
                <div class="mt-3 d-flex flex-column gap-4">
                    <div class="row gx-3">
                        <div class="col-md-6">
                            <label for="" class="form-label">Name*</label>
                            <input type="text" class="form-control" placeholder="Enter your name">
                            <span class="text-danger font-xs"></span>
                        </div>
                        <div class="col-md-6">
                            <label for="" class="form-label">Surname*</label>
                            <input type="text" class="form-control" placeholder="Enter your surname">
                        </div>
                        <span class="text-danger font-xs"></span>
                    </div>
                    <div class="row gx-3">
                        <div class="col-md-6">
                            <label for="" class="form-label">Employee ID</label>
                            <input type="text" class="form-control" placeholder="Enter your Employee ID">
                        </div>
                        <div class="col-md-6">
                            <label for="" class="form-label">Title</label>
                            <input type="text" class="form-control" placeholder="Enter Your Job Title">
                        </div>
                    </div>
                    <div class="col-12">
                        <label for="" class="form-label">Department</label>
                        <input type="text" class="form-control" placeholder="Enter your department">
                    </div>
                    <div>
                        <label for="" class="form-label">My Profile*</label>
                        <textarea class="form-control" rows="4" placeholder="Enter about yourself"></textarea>
                    </div>
                    <div>
                        <label for="" class="form-label">Why I Volunteer?</label>
                        <textarea class="form-control" rows="4"
                            placeholder="Enter reason for why you want to volunteer"></textarea>
                    </div>
                </div>

                <!-- Additional Information -->
                <div class="mt-4">
                    <div class="border-bottom">
                        <div class="custom-border-bottom pb-2 mx-content font-22 text-black-1">
                            Additional Information
                        </div>
                    </div>
                    <div class="row gx-3 mt-3">
                        <div class="col-md-6">
                            <label for="" class="form-label">City*</label>
                            <select class="form-select" id="city-menu">
                                <option value="" disabled selected>Select City</option>
                                <option value="1" data-countryid="1">Ahmedabad</option>
                                <option value="2" data-countryid="1">Gandhinagar</option>
                                <option value="3" data-countryid="2">Sydney</option>
                                <option value="4" data-countryid="1">Mumbai</option>
                                <option value="5" data-countryid="2">Canbera</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label for="" class="form-label">Country*</label>
                            <select class="form-select" id="country-menu">
                                <option value="" disabled selected>Select Country</option>
                                <option value="1">India</option>
                                <option value="2">Australia</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Professional Information -->
                <div class="mt-4">
                    <div class="border-bottom">
                        <div class="custom-border-bottom pb-2 mx-content font-22 text-black-1">
                            Professional Information
                        </div>
                    </div>
                    <div class="row gx-3 mt-3">
                        <div class="col-md-6">
                            <label for="" class="form-label">Availability</label>
                            <select class="form-select">
                                <option value="" disabled selected>Select Availability</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label for="" class="form-label">LinkedIn</label>
                            <input type="text" class="form-control" placeholder="Enter your LinkedIn URL">
                        </div>
                    </div>
                </div>


                <!-- My Skills -->
                <div class="mt-4">
                    <div class="border-bottom">
                        <div class="custom-border-bottom pb-2 mx-content font-22 text-black-1">
                            My Skills
                        </div>
                    </div>
                    <div class="border mt-3">
                        <ul class="list-unstyled ps-3 py-2 mb-0 fw-light font-xs text-black-1 d-flex flex-column gap-2" id="user-profile-skill">
                            <li>
                                Anthrology
                            </li>
                            <li>
                                Archeology
                            </li>
                            <li>
                                Astronomy
                            </li>
                            <li>
                                Computer Science
                            </li>
                            <li>
                                History
                            </li>
                        </ul>
                        <div class="ps-3 py-2 fw-light font-xs text-danger d-none">
                            No skill added!
                        </div>
                    </div>
                    <a class="btn-g-orange mx-content mt-2" data-bs-toggle="modal" data-bs-target="#addSkillModal">
                        Add Skills
                    </a>
                </div>

                <button class="btn-g-orange ms-auto mt-2">
                    Save
                </button>
            </form>
        </div>

        <!-- Basic information section end  -->

    </section>
    <!-- User profile section end  -->

    <footer class="border mt-2">
        <div class="container p-4">
            <a href="#" class="font-xs text-light-custom text-black-1 cursor-pointer">
                Privacy Policy
            </a>

            <a class="font-xs fw-light text-black-1 ms-4 cursor-pointer" id="btn-contact-us"> Contact Us </a>
        </div>
    </footer>

    <!-- Change Password Modal Begin -->
    <div class="modal" tabindex="-1" id="changePasswordModal">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header border-0">
                    <h5 class="modal-title font-22 text-black-1">Change Password</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form action="" class="user-modal-form">
                    <div class="modal-body d-flex flex-column gap-4">
                        <input class="form-control" placeholder="Enter old password">
                        <input class="form-control" placeholder="Enter new password">
                        <input class="form-control" placeholder="Enter confirm password">
                    </div>
                    <div class="modal-footer border-0">
                        <button type="button" class="btn-g-gray" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn-g-orange">Change Password</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <!-- Change password modal finish -->

    <!-- Add your skill modal begin -->
    <div class="modal" tabindex="-1" id="addSkillModal">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header border-0">
                    <h5 class="modal-title font-22 text-black-1">Add Skills</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="d-flex gap-3 skill-list">
                        <div class="border flex-basis">
                            <ul class="list-unstyled pt-2 font-xs fw-light d-flex flex-column gap-1" id="all-skill">
                                <li data-skillid="1">Anthrology</li>
                                <li data-skillid="2">History</li>
                                <li data-skillid="3">Computer Science</li>
                                <li data-skillid="4">Archeology</li>
                                <li data-skillid="5">Botany</li>
                                <li data-skillid="6">Mechanic</li>
                                <li data-skillid="7">Astronomy</li>
                            </ul>
                        </div>
                        <div class="d-flex align-items-center flex-column justify-content-center gap-3">
                            <img src="./assets/right-arrow1.png" alt="Add" id="usr-skill-add">
                            <img src="./assets/left.png" alt="Remove" id="usr-skill-remove">
                        </div>

                        <div class="border flex-basis">
                            <ul class="list-unstyled pt-2 font-xs fw-light d-flex flex-column gap-1" id="user-skill">
                            </ul>
                        </div>
                    </div>

                </div>
                <div class="modal-footer border-0 justify-content-start">
                    <button type="button" class="btn-g-gray" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn-g-orange" id="btn-skill-save">Save</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Add your skill modal finsih -->

    <!-- Contact Us Form Modal Begin -->
    <div class="modal" tabindex="-1" id="contactUsFormModal">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header border-0">
                    <h5 class="modal-title font-22 text-black-1">Contact Us</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form action="" class="user-modal-form" id="contact-form">
                    <div class="modal-body d-flex flex-column gap-3">
                        <div>
                            <label class= "form-label" for="">Name*</label>
                            <input type="text" class="form-control" value="BlahBlah" disabled>
                        </div>
                        <div>
                            <label class="form-label" for="">Email*</label>
                            <input type="text" class="form-control" value="BlahBlah" disabled>
                        </div>
                        <div>
                            <label class="form-label" for="">Subject*</label>
                            <input type="text" class="form-control">
                            <span class="font-xs text-danger"></span>
                        </div>
                        <div>
                            <label for="" class="form-label">Message*</label>
                            <textarea class="form-control" rows="3"></textarea>
                            <span class="font-xs text-danger"></span>
                        </div>

                    </div>
                    <div class="modal-footer border-0">
                        <button type="button" class="btn-g-gray" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn-g-orange" type="submit">Save</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <!-- Contact Us Form Modal finish -->

    <script src="./js/bootstrap.bundle.min.js"></script>
    <script>
        const imgUpload = document.querySelector('#usr-profile-upload');
        const profileImg = document.querySelector('#usr-profile-img');

        imgUpload.addEventListener
            (
                'change',
                (e) => {
                    const file = imgUpload.files[0];

                    profileImg.src = URL.createObjectURL(file);
                }
            );

        $('#country-menu option').click
            (
                () => {
                    let countryId = $('#country-menu').find(':selected').val();
                    handleCityDisplayOption(countryId);
                }
            );

        let cityList = $('[data-countryid]')
        function handleCityDisplayOption(countryId) {

            
            if( $('#city-menu').find(':selected').data('countryid') != countryId ){
                $('#city-menu option[value=""]').prop('selected', true);
            }

            $.each(cityList, (_, item) => {
                let id = $(item).data('countryid');

                if (countryId === undefined) return;

                if (id == countryId)
                    $(item).show();
                else
                    $(item).hide();
            });
        }
        
        const userSkillMap = new Map();
        const userSkillList = [];
        let currentSelectedSkill = {};
        //For add/remove skill
        $('#user-skill li').each(function() {
            const skillid = $(this).attr('data-skillid');
            // userSkillList.push(skillid);
            userSkillMap.set(skillid , $(this).text() );
        });
        handleAllSkillActive();
        function handleAllSkillActive(){
            $('#all-skill li').each(function() {
                const skillid = $(this).attr('data-skillid');
                if( userSkillMap.has(skillid) )
                {
                    $(this).addClass('active');
                }
                else
                {
                    $(this).removeClass('active');
                }
            });
        }

        let prevSkill;
        $('#all-skill li').each
        (
            (_, item) =>
            {
                $(item).click
                (
                    ()=> 
                    {
                        const skillid = $(item).attr('data-skillid');
                        
                        if( !$.isEmptyObject(prevSkill) && prevSkill.attr('data-skillid') !== skillid && !userSkillMap.has( prevSkill.attr('data-skillid') ) ) { 
                            prevSkill.removeClass('active'); 
                        }
                        prevSkill = $(item);

                        if( !userSkillMap.has(skillid) )
                        {
                            $(item).addClass('active');
                            currentSelectedSkill.skillid = skillid;
                            currentSelectedSkill.skill = $(item).text();
                            currentSelectedSkill.from = 'allskill';
                        }
                        
                    }
                );
            }
        );

        $('#usr-skill-add').click
        (
            () =>
            {
                if( Object.keys(currentSelectedSkill).length !== 0 && !userSkillMap.has( currentSelectedSkill.skillid ))
                {
                    if( currentSelectedSkill.from == 'allskill' )
                    {
                        let skillLi = $("<li>").text(currentSelectedSkill.skill).attr('data-skillid', currentSelectedSkill.skillid);
                        skillLi.click( selectFromUserSkill );
                        $('#user-skill').append(skillLi);
                        userSkillMap.set( currentSelectedSkill.skillid, currentSelectedSkill.skill );
                    }
                }
            }
        );
    
            
        let selectedRemoveSkill;
        $('#user-skill li').each
        (
            (_, item) =>
            {
                $(item).click
                (
                    selectFromUserSkill
                );
            }
        );

        function selectFromUserSkill(event) 
        {
            event.preventDefault();
            $('#user-skill li').removeClass('active');
            $(this).addClass('active');
            selectedRemoveSkill = $(this);
        }

        $('#usr-skill-remove').click
        (
            () =>
            {
                if(selectedRemoveSkill !== undefined && !$.isEmptyObject(selectedRemoveSkill))
                {
                    const skillid = $(selectedRemoveSkill).attr('data-skillid');
                    userSkillMap.delete(skillid);
                    selectedRemoveSkill.remove();
                    console.log(userSkillMap);
                    handleAllSkillActive();
                }
            }
        );

        $('#btn-skill-save').click(displayUserProfileSkills);
        function displayUserProfileSkills()
        {
            $('#user-profile-skill').empty();

            for(const[skillid, skill] of userSkillMap)
            {
                let li = $("<li>").text(skill).attr('data-skillid', skillid);
                let inputElement = $('<input>', {
                    type: 'hidden',
                    value: skillid,
                    name: 'finalSkillList'
                });
                $('#user-profile-skill').append(li);
                $('#user-profile-skill').append(inputElement);
            }

            if( userSkillMap.size === 0 )
            {
                $('#no-skill').removeClass();
            }
            else
            {
                $('#no-skill').addClass('d-none');
            }
            $('#addSkillModal').modal('hide');
        }
        
        $('#btn-contact-us').click
        (
            () =>
            {
                $('#contactUsFormModal').modal('show');
            }
        );
    </script>
</body>

</html>